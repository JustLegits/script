--[[
  Executor Script: Draggable UI Opener Tool
  - Toggle button ƒë·ªÉ m·ªü panel
  - Panel c√≥:
      ‚Ä¢ Dropdown ch·ªçn ScreenGui t·ª´ PlayerGui
      ‚Ä¢ N√∫t M·ªü/·∫®n UI
  - C√≥ cu·ªôn n·∫øu danh s√°ch d√†i
--]]

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "GuiOpenerUI"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true

-- Toggle Button (side)
local toggleBtn = Instance.new("TextButton")
toggleBtn.Name = "ToggleButton"
toggleBtn.Text = "‚ò∞"
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 24
toggleBtn.Size = UDim2.new(0, 40, 0, 40)
toggleBtn.Position = UDim2.new(0, 5, 0.5, -20)
toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
toggleBtn.BorderSizePixel = 0
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Parent = screenGui

-- Main Frame
local frame = Instance.new("Frame")
frame.Name = "MainFrame"
frame.Size = UDim2.new(0, 300, 0, 260)
frame.Position = UDim2.new(0, 50, 0.4, -130)
frame.BackgroundColor3 = Color3.fromRGB(28, 28, 30)
frame.BorderSizePixel = 0
frame.Visible = false
frame.Parent = screenGui

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
title.Text = "üéõÔ∏è UI Toggle Panel"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.Parent = frame

-- Dropdown Label
local dropdownLabel = Instance.new("TextLabel")
dropdownLabel.Text = "Danh s√°ch UI:"
dropdownLabel.TextColor3 = Color3.new(1,1,1)
dropdownLabel.Font = Enum.Font.Gotham
dropdownLabel.TextSize = 14
dropdownLabel.Size = UDim2.new(1, -40, 0, 24)
dropdownLabel.Position = UDim2.new(0, 20, 0, 40)
dropdownLabel.BackgroundTransparency = 1
dropdownLabel.Parent = frame

-- Scrolling dropdown list
local dropdownFrame = Instance.new("ScrollingFrame")
dropdownFrame.Size = UDim2.new(1, -40, 0, 140)
dropdownFrame.Position = UDim2.new(0, 20, 0, 70)
dropdownFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
dropdownFrame.BorderSizePixel = 0
dropdownFrame.ScrollBarThickness = 6
dropdownFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
dropdownFrame.Parent = frame

local listLayout = Instance.new("UIListLayout", dropdownFrame)
listLayout.Padding = UDim.new(0, 2)

-- Selected GUI
local selectedGui = Items

-- Toggle UI Button
local toggleGuiBtn = Instance.new("TextButton")
toggleGuiBtn.Text = "M·ªü/·∫®n UI ƒë√£ ch·ªçn"
toggleGuiBtn.Size = UDim2.new(1, -40, 0, 40)
toggleGuiBtn.Position = UDim2.new(0, 20, 1, -50)
toggleGuiBtn.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
toggleGuiBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleGuiBtn.Font = Enum.Font.GothamBold
toggleGuiBtn.TextSize = 14
toggleGuiBtn.Parent = frame

-- Toggle visibility of panel
toggleBtn.MouseButton1Click:Connect(function()
    frame.Visible = not frame.Visible
    toggleBtn.Text = frame.Visible and "√ó" or "‚ò∞"
end)

-- Dragging logic
local dragging, dragInput, dragStart, startPos
local function updateDrag(input)
    local delta = input.Position - dragStart
    frame.Position = UDim2.new(
        startPos.X.Scale, startPos.X.Offset + delta.X,
        startPos.Y.Scale, startPos.Y.Offset + delta.Y
    )
end

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        updateDrag(input)
    end
end)

-- Populate dropdown with ScreenGui list
local function refreshGuiList()
    dropdownFrame:ClearAllChildren()
    listLayout.Parent = dropdownFrame

    local totalHeight = 0

    for _, gui in pairs(playerGui:GetChildren()) do
        if gui:IsA("ScreenGui") and gui.Name ~= "GuiOpenerUI" then
            local option = Instance.new("TextButton")
            option.Size = UDim2.new(1, 0, 0, 28)
            option.Text = gui.Name
            option.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
            option.TextColor3 = Color3.new(1,1,1)
            option.Font = Enum.Font.Gotham
            option.TextSize = 13
            option.Parent = dropdownFrame

            option.MouseButton1Click:Connect(function()
                selectedGui = gui
                dropdownLabel.Text = "ƒê√£ ch·ªçn: " .. gui.Name
            end)

            totalHeight += 30
        end
    end

    dropdownFrame.CanvasSize = UDim2.new(0, 0, 0, totalHeight)
end

refreshGuiList()

-- Toggle selected UI
toggleGuiBtn.MouseButton1Click:Connect(function()
    if selectedGui then
        selectedGui.Enabled = not selectedGui.Enabled
    else
        warn("[GuiOpenerUI] B·∫°n ch∆∞a ch·ªçn GUI n√†o.")
    end
end)
